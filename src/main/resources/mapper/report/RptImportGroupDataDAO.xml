<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.loushuiyifan.report.dao.RptImportGroupDataDAO">
    <select id="findSubcode" resultType="String">
		SELECT INDEX_CODE
  			FROM rpt_repfield_def_channel P
 			WHERE P.RPT_NO =#{rptNo}
   			AND GROUP_ID =#{groupId}
   			and index_code=#{subcode}	
	</select>

    <delete id="deleteGroup">
        delete from charge.dim_sub_group
        where latn_id=#{latnId}
        <if test='groupId !=""'>
            and group_id = #{groupId}
        </if>
    </delete>

    <select id="listData" resultType="com.loushuiyifan.report.vo.ImportDataGroupVO">
        select group_id as groupId,
        group_name as groupName,
        sub_code as subCode,
        sub_name as subName,
        user_id as userId,
        to_char(lst_upd, 'yyyy-MM-dd hh24:mi:ss') as lstUpd,
        latn_id as latnId
        from charge.dim_sub_group
        <choose>
        <when test='latnId !="0" and groupId !=""'>
        	where latn_id = #{latnId}
        	and group_id = #{groupId}
        </when>
        <when test='latnId !="0" and groupId ==""'>
         where latn_id = #{latnId}
        </when>
        <when test='latnId =="0" and groupId !=""'>
        where group_id = #{groupId}
        </when>       
        <otherwise></otherwise>
        </choose>

        order by  substr(group_id,3,4) desc,group_id
    </select>
</mapper>
