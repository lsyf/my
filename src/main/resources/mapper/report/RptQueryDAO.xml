<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.loushuiyifan.report.dao.RptQueryDAO">

    <select id="list" resultType="com.loushuiyifan.report.dto.ReportDataDTO">
        select a.zb_code as "x",
        a.cust_id as "y",
        <choose>
            <when test="type=='0'">
                to_char(a.zb_value, 'fm999999999990.00') as "v"
            </when>
            <when test="type=='1'">
                to_char(a.tax_value, 'fm999999999990.00') as "v"
            </when>
            <otherwise>
                to_char(a.aft_tax_value, 'fm999999999990.00') as "v"
            </otherwise>
        </choose>
        from stat_repfield_content_channel a
        where a.income_source = #{incomeSource}
        and a.local_net = #{latnId}
        and a.acct_month = #{month}
    </select>

</mapper>