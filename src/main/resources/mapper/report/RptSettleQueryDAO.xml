<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.loushuiyifan.report.dao.RptSettleQueryDAO">
	<select id="listData" resultType="com.loushuiyifan.report.vo.SettleDataVO" >
		select a.log_id as logId,
       a.REPORT_ID      as reportId,
       b.REPORT_name    as reportName,
       a.acct_month     as month,
       b.income_source    as incomeSource,
       decode(a.state, 0, '无', '1', '有数据') as status,      
       c.file_seq       as fileSeq,
       to_char(c.create_date, 'YYYY-MM-DD hh24:mi:ss') as createDate,
       to_char(c.import_date, 'YYYY-MM-DD hh24:mi:ss') as importDate
	  from rpt_sett_state a, rpt_sett_def b, rpt_sett_log c
	 where a.REPORT_ID = b.REPORT_ID
	   and a.log_id = c.log_id
	   and b.batch_id = c.batch_id
	   and a.acct_month = #{month}
	   and b.remark = 'Y'
	 	<if test='reportId !="0" '>
			and a.REPORT_ID = #{reportId}
		</if>
	 	order by b.remark DESC, a.report_id  
			
		
	</select> 
	
	
	
	<select id="listReportName" resultType="Map">
		select distinct 
		REPORT_ID as "id", 
		REPORT_ID || '-' || REPORT_NAME as "name",
		REPORT_ID as "data" 
		from rpt_sett_def
		order by REPORT_ID ASC
	</select>
</mapper>