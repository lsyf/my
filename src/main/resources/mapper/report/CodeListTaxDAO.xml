<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.loushuiyifan.report.dao.CodeListTaxDAO">

    <select id="listByType" resultType="Map">
      select a.code_id  as "id",
       a.code_name      as "name",
       a.code_id        as "data",
       a.parent_code_id as "parentId",
       a.code_level as "lvl"
       from code_list_tax a
        where a.type_code= #{type}
        order by a.code_level asc ,a.sorting desc
    </select>

    <select id="listIncomeSourceMap" resultType="Map">
      select a.code_id  as "id",
       a.code_name      as "name"
       from code_list_tax a
        where a.type_code= #{type}
        order by a.code_id asc
    </select>

    <select id="codeListTax" resultType="Map">
		select 	a.code_id        as "id", 
				a.code_name      as "name",
				a.code_id        as "data"
           from code_list_tax a
          	where a.type_code = #{type}
            and a.code_level = #{lvl}
      </select>
    <select id="listFromCodeListTax" resultType="com.loushuiyifan.report.bean.CodeListTax">
        select *
        from code_list_tax a
        where a.type_code = #{type}
        and a.code_level = #{lvl}

    </select>

    <select id="listIncomeSourceByLvl" resultType="Map">
		select a.code_id as "id",
       a.code_id || '-' || a.code_name as "name",
       a.code_id as "data"
	  from code_list_tax a
	 where a.type_code = #{type}
	   and a.code_id != 90
	   and a.code_level <![CDATA[ <= ]]> #{lvl}
	union
	select a.code_id as "id",
	       a.code_id || '-' || a.code_name as "name",
	       a.code_id as "data"
	  from code_list_tax a
	 where a.type_code = #{type}
	   and a.code_id in ('9001', '9002')
	</select>

    <select id="listKidsByTypeAndData" resultType="com.loushuiyifan.report.bean.CodeListTax">
select *
  from code_list_tax b
 where b.type_code = #{type}
   and (b.code_id = #{data} or b.parent_code_id = #{data})
    </select>
	
	<select id="codeNameById" resultType="String">
	 select a.code_name
		  from code_list_tax a
		 where a.type_code = #{type}
		   and a.code_id = #{id}
	
	</select>
</mapper>